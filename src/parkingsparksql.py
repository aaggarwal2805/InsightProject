from pyspark.sql import SparkSession
from pyspark.sql import Row
import collections


# Create a SparkSession
spark = SparkSession.builder.appName("ParkingSQL").enableHiveSupport().getOrCreate()

'''
#Create DataFrames
restriction = spark.read.format("csv").option("header", "true").option("mode", "DROPMALFORMED").load("s3n://sensorlocationdata/On-street_Car_Park_Bay_Restrictions.csv")
baydevice = spark.read.format("csv").option("header", "true").option("mode", "DROPMALFORMED").load("s3n://sensorlocationdata/On-street_Parking_Bay_Sensors.csv")
year2017 = spark.read.format("csv").option("header", "true").option("mode", "DROPMALFORMED").load("s3n://sensordevicedata/On-street_Car_Parking_Sensor_Data_-_2017.csv")
year2016 = spark.read.format("csv").option("header", "true").option("mode", "DROPMALFORMED").load("s3n://sensordevicedata/On-street_Car_Parking_Sensor_Data_-_2016.csv")
year2015 = spark.read.format("csv").option("header", "true").option("mode", "DROPMALFORMED").load("s3n://sensordevicedata/On-street_Car_Parking_Sensor_Data_-_2015.csv")
year2014 = spark.read.format("csv").option("header", "true").option("mode", "DROPMALFORMED").load("s3n://sensordevicedata/On-street_Car_Parking_Sensor_Data_-_2014.csv")
year2013 = spark.read.format("csv").option("header", "true").option("mode", "DROPMALFORMED").load("s3n://sensordevicedata/On-street_Car_Parking_Sensor_Data_-_2013.csv")
year2012 = spark.read.format("csv").option("header", "true").option("mode", "DROPMALFORMED").load("s3n://sensordevicedata/On-street_Car_Parking_Sensor_Data_-_2012.csv")
year2011 = spark.read.format("csv").option("header", "true").option("mode", "DROPMALFORMED").load("s3n://sensordevicedata/On-street_Car_Parking_Sensor_Data_-_2011.csv")
dt = spark.read.format("csv").option("header", "true").option("mode", "DROPMALFORMED").load("s3n://daytimeinput/DT.csv")


restriction.createOrReplaceTempView("restriction")
baydevice.createOrReplaceTempView("baydevice")
year2017.createOrReplaceTempView("year2017")
year2016.createOrReplaceTempView("year2016")
year2015.createOrReplaceTempView("year2015")
year2014.createOrReplaceTempView("year2014")
year2013.createOrReplaceTempView("year2013")
year2012.createOrReplaceTempView("year2012")
year2011.createOrReplaceTempView("year2011")
dt.createOrReplaceTempView("dt")
'''
#UNION OF TABLES (2011-2017)
#spark.sql("CREATE TABLE 1117alldata AS (SELECT year2017.DeviceId, year2017.ArrivalTime, year2017.DepartureTime FROM year2017 UNION ALL SELECT year2016.DeviceId, year2016.ArrivalTime, year2016.DepartureTime FROM year2016 UNION ALL SELECT year2015.DeviceId, year2015.ArrivalTime, year2015.DepartureTime FROM year2015 UNION ALL SELECT year2014.DeviceId, year2014.ArrivalTime, year2014.DepartureTime FROM year2014 UNION ALL SELECT year2013.DeviceId, year2013.ArrivalTime, year2013.DepartureTime FROM year2013 UNION ALL SELECT year2012.DeviceId, year2012.ArrivalTime, year2012.DepartureTime FROM year2012 UNION ALL SELECT year2011.DeviceId, year2011.ArrivalTime, year2011.DepartureTime FROM year2011)")

#JOIN TABLES (restriction + baydevice)
#spark.sql("CREATE TABLE rest_bay_locTable AS (SELECT restriction.DEVICE_ID,  baydevice.lat, baydevice.lon from restriction FULL OUTER JOIN baydevice ON restriction.BAY_ID==baydevice.bay_Id WHERE baydevice.lat IS NOT NULL)")

#spark.sql("CREATE TABLE bt AS (SELECT * FROM baydevice)")


#spark.sql("CREATE TABLE dev_loc_table AS (SELECT 1117alldata.DeviceId, 1117alldata.ArrivalTime, 1117alldata.DepartureTime, rest_bay_locTable.lat, rest_bay_locTable.lon FROM 1117alldata FULL OUTER JOIN rest_bay_locTable ON 1117alldata.DeviceId==rest_bay_locTable.DEVICE_ID WHERE rest_bay_locTable.lat IS NOT NULL)")

#spark.sql("CREATE TABLE FINAL (SELECT CAST(dev_loc_table.DeviceId AS INT) AS DeviceId, TO_TIMESTAMP(CAST (UNIX_TIMESTAMP(dev_loc_table.ArrivalTime, 'MM/dd/yyyy h:mm:ss a') AS TIMESTAMP)) AS ArrivalTime, TO_TIMESTAMP(CAST (UNIX_TIMESTAMP(dev_loc_table.DepartureTime, 'MM/dd/yyyy h:mm:ss a') AS TIMESTAMP)) AS DepartureTime, CAST(dev_loc_table.lat AS DECIMAL(30,20)) AS lat, CAST(dev_loc_table.lon AS DECIMAL(30,20)) AS lon FROM dev_loc_table)")

#spark.sql("CREATE TABLE rt AS (SELECT * FROM restriction)")

#spark.sql("CREATE TABLE BayL AS (SELECT rt.DEVICE_ID, bt.location, bt.lat, bt.lon FROM rt FULL OUTER JOIN bt ON bt.bay_id == rt.BAY_ID)")

#spark.sql("CREATE TABLE DevLoc AS (SELECT deviceTable.DeviceId, BayL.location, BayL.lat, BayL.lon, deviceTable.ArrivalTime, deviceTable.DepartureTime FROM deviceTable FULL OUTER JOIN BayL ON deviceTable.DeviceID==BayL.DEVICE_ID)")


#spark.sql("CREATE TABLE deviceTable AS (SELECT year2013.DeviceId, year2013.ArrivalTime, year2013.DepartureTime FROM year2013 UNION ALL SELECT year2014.DeviceId, year2014.ArrivalTime, year2014.DepartureTime FROM year2014)")


#deviceloc = spark.sql("SELECT alldevice.DeviceId, alldevice.ArrivalTime, alldevice.DepartureTime, bayloc.location, bayloc.lat, bayloc.log FROM alldevice JOIN bayloc ON alldevice.DeviceId == bayloc.DEVICE_ID")
#deviceloc.createOrReplaceTempView("deviceloc")


#spark.sql("CREATE TABLE DT AS (SELECT CAST(dt.DOW AS INT) AS DOW, dt.Day, CAST(dt.Time AS INT) AS Time FROM dt)")


#CONVERTING TIMESTAMP TO DAY AND HOUR

#spark.sql("CREATE TABLE DEVICEDT AS (SELECT FINAL.DeviceID, dayOfWeek(FINAL.ArrivalTime) AS Day, hour(FINAL.ArrivalTime) AS Time, FINAL.lat, FINAL.lon FROM FINAL)")

#spark.sql("CREATE TABLE DEV AS (SELECT DEVICEDT.DeviceID, DT.Day, DEVICEDT.Time, DEVICEDT.lat, DEVICEDT.lon FROM DEVICEDT LEFT OUTER JOIN DT ON DEVICEDT.Day == DT.DOW)")

COUNTDEV = spark.sql("(SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Mon' AND DEV.Time = 1 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Mon' AND DEV.Time = 2 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Mon' AND DEV.Time = 3 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Mon' AND DEV.Time = 4 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Mon' AND DEV.Time = 5 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Mon' AND DEV.Time = 6 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon)  UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Mon' AND DEV.Time = 7 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Mon' AND DEV.Time = 8 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Mon' AND DEV.Time = 9 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Mon' AND DEV.Time = 10 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Mon' AND DEV.Time = 11 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Mon' AND DEV.Time = 12 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Mon' AND DEV.Time = 13 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Mon' AND DEV.Time = 14 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Mon' AND DEV.Time = 15 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Mon' AND DEV.Time = 16 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Mon' AND DEV.Time = 17 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Mon' AND DEV.Time = 18 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Mon' AND DEV.Time = 19 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Mon' AND DEV.Time = 20 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Mon' AND DEV.Time = 21 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Mon' AND DEV.Time = 22 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Mon' AND DEV.Time = 23 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Mon' AND DEV.Time = 00 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Tue' AND DEV.Time = 1 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Tue' AND DEV.Time = 2 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Tue' AND DEV.Time = 3 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Tue' AND DEV.Time = 4 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Tue' AND DEV.Time = 5 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Tue' AND DEV.Time = 6 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon)  UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Tue' AND DEV.Time = 7 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Tue' AND DEV.Time = 8 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Tue' AND DEV.Time = 9 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Tue' AND DEV.Time = 10 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Tue' AND DEV.Time = 11 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Tue' AND DEV.Time = 12 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Tue' AND DEV.Time = 13 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Tue' AND DEV.Time = 14 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Tue' AND DEV.Time = 15 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Tue' AND DEV.Time = 16 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Tue' AND DEV.Time = 17 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Tue' AND DEV.Time = 18 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Tue' AND DEV.Time = 19 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Tue' AND DEV.Time = 20 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Tue' AND DEV.Time = 21 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Tue' AND DEV.Time = 22 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Tue' AND DEV.Time = 23 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Tue' AND DEV.Time = 00 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Wed' AND DEV.Time = 1 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Wed' AND DEV.Time = 2 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Wed' AND DEV.Time = 3 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Wed' AND DEV.Time = 4 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Wed' AND DEV.Time = 5 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Wed' AND DEV.Time = 6 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon)  UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Wed' AND DEV.Time = 7 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Wed' AND DEV.Time = 8 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Wed' AND DEV.Time = 9 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Wed' AND DEV.Time = 10 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Wed' AND DEV.Time = 11 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Wed' AND DEV.Time = 12 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Wed' AND DEV.Time = 13 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Wed' AND DEV.Time = 14 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Wed' AND DEV.Time = 15 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Wed' AND DEV.Time = 16 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Wed' AND DEV.Time = 17 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Wed' AND DEV.Time = 18 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Wed' AND DEV.Time = 19 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Wed' AND DEV.Time = 20 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Wed' AND DEV.Time = 21 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Wed' AND DEV.Time = 22 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Wed' AND DEV.Time = 23 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Wed' AND DEV.Time = 00 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Thu' AND DEV.Time = 1 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Thu' AND DEV.Time = 2 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Thu' AND DEV.Time = 3 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Thu' AND DEV.Time = 4 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Thu' AND DEV.Time = 5 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Thu' AND DEV.Time = 6 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon)  UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Thu' AND DEV.Time = 7 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Thu' AND DEV.Time = 8 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Thu' AND DEV.Time = 9 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Thu' AND DEV.Time = 10 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Thu' AND DEV.Time = 11 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Thu' AND DEV.Time = 12 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Thu' AND DEV.Time = 13 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Thu' AND DEV.Time = 14 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Thu' AND DEV.Time = 15 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Thu' AND DEV.Time = 16 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Thu' AND DEV.Time = 17 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Thu' AND DEV.Time = 18 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Thu' AND DEV.Time = 19 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Thu' AND DEV.Time = 20 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Thu' AND DEV.Time = 21 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Thu' AND DEV.Time = 22 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Thu' AND DEV.Time = 23 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Thu' AND DEV.Time = 00 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Fri' AND DEV.Time = 1 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Fri' AND DEV.Time = 2 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Fri' AND DEV.Time = 3 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Fri' AND DEV.Time = 4 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Fri' AND DEV.Time = 5 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Fri' AND DEV.Time = 6 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon)  UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Fri' AND DEV.Time = 7 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Fri' AND DEV.Time = 8 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Fri' AND DEV.Time = 9 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Fri' AND DEV.Time = 10 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Fri' AND DEV.Time = 11 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Fri' AND DEV.Time = 12 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Fri' AND DEV.Time = 13 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Fri' AND DEV.Time = 14 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Fri' AND DEV.Time = 15 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Fri' AND DEV.Time = 16 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Fri' AND DEV.Time = 17 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Fri' AND DEV.Time = 18 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Fri' AND DEV.Time = 19 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Fri' AND DEV.Time = 20 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Fri' AND DEV.Time = 21 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Fri' AND DEV.Time = 22 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Fri' AND DEV.Time = 23 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Fri' AND DEV.Time = 00 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Sat' AND DEV.Time = 1 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Sat' AND DEV.Time = 2 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Sat' AND DEV.Time = 3 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Sat' AND DEV.Time = 4 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Sat' AND DEV.Time = 5 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Sat' AND DEV.Time = 6 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon)  UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Sat' AND DEV.Time = 7 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Sat' AND DEV.Time = 8 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Sat' AND DEV.Time = 9 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Sat' AND DEV.Time = 10 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Sat' AND DEV.Time = 11 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Sat' AND DEV.Time = 12 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Sat' AND DEV.Time = 13 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Sat' AND DEV.Time = 14 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Sat' AND DEV.Time = 15 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Sat' AND DEV.Time = 16 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Sat' AND DEV.Time = 17 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Sat' AND DEV.Time = 18 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Sat' AND DEV.Time = 19 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Sat' AND DEV.Time = 20 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Sat' AND DEV.Time = 21 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Sat' AND DEV.Time = 22 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Sat' AND DEV.Time = 23 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Sat' AND DEV.Time = 00 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Sun' AND DEV.Time = 1 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Sun' AND DEV.Time = 2 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Sun' AND DEV.Time = 3 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Sun' AND DEV.Time = 4 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Sun' AND DEV.Time = 5 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Sun' AND DEV.Time = 6 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon)  UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Sun' AND DEV.Time = 7 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Sun' AND DEV.Time = 8 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Sun' AND DEV.Time = 9 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Sun' AND DEV.Time = 10 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Sun' AND DEV.Time = 11 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Sun' AND DEV.Time = 12 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Sun' AND DEV.Time = 13 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Sun' AND DEV.Time = 14 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Sun' AND DEV.Time = 15 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Sun' AND DEV.Time = 16 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Sun' AND DEV.Time = 17 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Sun' AND DEV.Time = 18 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Sun' AND DEV.Time = 19 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Sun' AND DEV.Time = 20 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Sun' AND DEV.Time = 21 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Sun' AND DEV.Time = 22 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Sun' AND DEV.Time = 23 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon) UNION ALL (SELECT COUNT(DEV.DeviceID), DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon FROM DEV WHERE DEV.Day = 'Sun' AND DEV.Time = 00 GROUP BY DEV.DeviceID, DEV.Day, DEV.Time, DEV.lat, DEV.lon)")
